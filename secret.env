DB_URL=jdbc:mysql://ls-09c568874e30cb3635ca525d02ff2051c381f5d0.c14s8aaeg9qd.ap-northeast-2.rds.amazonaws.com:3306/mannal?useSSL=true&serverTimezone=Asia/Seoul
DB_USERNAME=dbmasteruser
DB_PASSWORD=d7EoncJZ9C5[^rf-hrZ1t{[e(tH=:zR^
JWT_SECRET=aREfPM7W7RDYpOd5BV0zGKKz1Q3anizmxGP8lN0nkneqHzhmNPtBq8Sxurc/tIAUfcXlc1RoPmdjqlA7Ze3Kug==
KAKAO_CLIENT_ID=f0bfa98dfa477735feeb8dbfdfa1d105
KAKAO_CLIENT_SECRET=U4JgTAZGirCvVGmmnvuSlsoWlKFPstvV

==========================
JWT_SECRET 생성 방법:
openssl rand -base64 64
==========================


완료되었습니다! 카카오 OAuth Redirect URI가 환경별로 올바르게 설정되었습니다.

  수정 완료 내용

  1. application-prod.yaml (src/main/resources/)

  # 쿠키 보안 설정
  cookie:
    secure: false  # HTTP 환경 (HTTPS 도메인 없음)

  # CORS 허용 출처
  cors:
    allowed-origins:
      - http://13.124.241.22  # 프로덕션 프론트엔드 (포트 80)

  # OAuth 리다이렉트 설정
  oauth:
    kakao-redirect-url: http://13.124.241.22/oauth/callback  # 프론트엔드로 리다이렉트

  2. .github/workflows/deploy.yml

  # 카카오 OAuth 설정
  KAKAO_REDIRECT_URI=http://13.124.241.22:8080/auth/kakao/callback  # 백엔드 콜백 (포트 8080)

  3. .env.example

  주석 추가로 설명 개선:
  # 카카오가 인증 후 호출하는 백엔드 콜백 URI (카카오 개발자 콘솔에 등록해야 함)
  # 개발: http://localhost:9080/auth/kakao/callback
  # 프로덕션: http://13.124.241.22:8080/auth/kakao/callback
  KAKAO_REDIRECT_URI=http://localhost:9080/auth/kakao/callback

  환경별 설정 정리

  📍 개발 환경 (dev)

  | 설정 항목      | 값                                         | 설명                    |
  |------------|-------------------------------------------|-----------------------|
  | 백엔드 포트     | 9080                                      | localhost:9080        |
  | 프론트엔드 포트   | 5173                                      | localhost:5173 (Vite) |
  | 카카오 콜백 URI | http://localhost:9080/auth/kakao/callback | 카카오가 백엔드 호출           |
  | 프론트 리다이렉트  | http://localhost:5173/oauth/callback      | 백엔드가 프론트 리다이렉트        |
  | 쿠키 Secure  | false                                     | HTTP 개발 환경            |

  📍 프로덕션 환경 (prod)

  | 설정 항목      | 값                                             | 설명                 |
  |------------|-----------------------------------------------|--------------------|
  | 백엔드 포트     | 8080                                          | 13.124.241.22:8080 |
  | 프론트엔드 포트   | 80                                            | 13.124.241.22      |
  | 카카오 콜백 URI | http://13.124.241.22:8080/auth/kakao/callback | 카카오가 백엔드 호출        |
  | 프론트 리다이렉트  | http://13.124.241.22/oauth/callback           | 백엔드가 프론트 리다이렉트     |
  | 쿠키 Secure  | false                                         | HTTP 환경 (도메인 없음)   |
  | CORS       | http://13.124.241.22                          | 프론트엔드 출처           |

  ⚠️ 카카오 개발자 콘솔 설정 필수!

  카카오 로그인이 작동하려면 카카오 개발자 콘솔에서 Redirect URI를 등록해야 합니다:

  카카오 개발자 콘솔 설정 방법

  1. https://developers.kakao.com/console/app 접속
  2. 애플리케이션 선택 → 제품 설정 → 카카오 로그인
  3. Redirect URI 등록:
  # 개발 환경
  http://localhost:9080/auth/kakao/callback

  # 프로덕션 환경
  http://13.124.241.22:8080/auth/kakao/callback
  4. 활성화 설정 → 카카오 로그인 ON
  5. 동의 항목 → 이메일 필수 동의로 설정

  OAuth 흐름 요약

  1. 사용자가 프론트엔드에서 "카카오 로그인" 클릭
     ↓
  2. 프론트엔드 → 백엔드 /auth/kakao/login 호출
     ↓
  3. 백엔드 → 카카오 로그인 페이지로 리다이렉트
     ↓
  4. 카카오 인증 완료 → 백엔드 콜백 호출
     [개발] http://localhost:9080/auth/kakao/callback
     [프로덕션] http://13.124.241.22:8080/auth/kakao/callback
     ↓
  5. 백엔드 → JWT 발급 → 프론트엔드로 리다이렉트
     [개발] http://localhost:5173/oauth/callback?status=success
     [프로덕션] http://13.124.241.22/oauth/callback?status=success
     ↓
  6. 프론트엔드 → /auth/kakao/exchange-token 호출하여 쿠키 설정

  모든 설정이 환경별로 올바르게 구성되었습니다!



DOCKER_CONFIG=${DOCKER_CONFIG:/usr/local/lib/docker/cli-plugins}